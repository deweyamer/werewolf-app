# 狼人杀游戏使用指南

## 📋 目录
- [快速开始](#快速开始)
- [账号说明](#账号说明)
- [游戏流程](#游戏流程)
- [角色说明](#角色说明)
- [常见问题](#常见问题)

---

## 🚀 快速开始

### 1. 安装依赖

```bash
cd werewolf-app
npm install
```

### 2. 启动服务器

打开第一个终端窗口：
```bash
cd server
npm run dev
```

看到以下信息表示服务器启动成功：
```
🎮 Werewolf Server is running on port 3001
📡 WebSocket endpoint: ws://localhost:3001
🔧 REST API endpoint: http://localhost:3001/api

默认管理员账号：
  用户名: admin
  密码: admin123
```

### 3. 启动客户端

打开第二个终端窗口：
```bash
cd client
npm run dev
```

看到以下信息表示客户端启动成功：
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:3000/
```

### 4. 访问游戏

在浏览器中打开：http://localhost:3000

---

## 👥 账号说明

系统启动后会自动创建以下账号：

### 默认账号

| 角色 | 用户名 | 密码 | 说明 |
|-----|--------|------|------|
| 管理员 | `admin` | `admin123` | 管理用户和剧本 |
| 上帝 | `god` | `god` | 主持游戏 |
| 测试玩家1 | `test1` | `test` | 测试账号 |
| 测试玩家2 | `test2` | `test` | 测试账号 |
| ... | ... | ... | ... |
| 测试玩家12 | `test12` | `test` | 测试账号 |

### 注册新玩家

玩家可以在登录页面点击"注册"按钮自行注册账号：
1. 点击"注册"标签
2. 输入用户名（唯一）
3. 输入密码（至少4位）
4. 点击"注册"按钮
5. 注册成功后切换到"登录"标签进行登录

---

## 🎮 游戏流程

### 第一步：上帝创建房间

1. 使用上帝账号登录（god / god）
2. 进入上帝控制台
3. 选择剧本（目前仅支持"摄梦人12人版"）
4. 点击"创建房间"
5. 记下生成的6位房间码（例如：ABC123）

### 第二步：玩家加入房间

1. 使用玩家账号登录（test1-test12 / test）
2. 进入玩家视图
3. 输入房间码
4. 点击"加入房间"
5. 等待其他玩家加入（需要12人）

**提示**：可以在12个不同的浏览器标签页中分别登录12个测试账号进行测试。

### 第三步：上帝分配角色

当12名玩家全部加入后：
1. 上帝点击"分配角色"按钮
2. 弹出角色分配对话框，显示剧本配置：
   - 噩梦之影 x1（狼人）
   - 普通狼人 x3（狼人）
   - 摄梦人 x1（好人）
   - 女巫 x1（好人）
   - 预言家 x1（好人）
   - 猎人 x1（好人）
   - 平民 x4（好人）
3. **两种分配方式**：
   - **随机分配**：点击"🎲 随机分配"按钮，系统自动随机分配所有角色
   - **手动分配**：为每个玩家手动选择角色
4. 点击"确认分配"
5. 每个玩家会收到弹窗通知自己的角色和阵营

### 第四步：开始游戏

1. 上帝点击"开始游戏"按钮
2. 游戏进入第1回合的"恐惧阶段"

### 第五步：游戏进行

游戏按以下阶段循环进行：

#### 夜间阶段

1. **恐惧阶段**（噩梦之影行动）
   - 噩梦之影选择一名玩家恐惧
   - 被恐惧的玩家本回合无法使用技能
   - 上帝点击"进入下一阶段"

2. **守护阶段**（摄梦人行动）
   - 摄梦人选择一名玩家守护
   - 若被守护者被狼刀，摄梦人替死
   - 上帝点击"进入下一阶段"

3. **狼人阶段**（狼人集体行动）
   - 所有狼人讨论并选择刀人目标
   - 上帝根据狼人决定提交操作
   - 上帝点击"进入下一阶段"

4. **女巫阶段**（女巫行动）
   - 女巫知道当晚谁被狼刀
   - 可选择：使用解药救人 / 使用毒药毒人 / 不使用
   - **注意**：首夜不救人，被刀者会死亡
   - 上帝点击"进入下一阶段"

5. **预言家阶段**（预言家行动）
   - 预言家选择一名玩家查验身份
   - 得知该玩家是好人还是狼人
   - 上帝点击"进入下一阶段"

6. **夜间结算**
   - 系统自动计算死亡结果
   - 公布昨晚死亡的玩家号位
   - 上帝点击"进入下一阶段"

#### 白天阶段

7. **警长竞选**（仅第一天）
   - 玩家自愿上警竞选
   - 上帝确认警长人选
   - 警长拥有1.5票投票权（显示🎖️标志）
   - 上帝点击"进入下一阶段"

8. **投票放逐**
   - 所有存活玩家投票放逐一名玩家
   - 上帝根据投票结果提交
   - 上帝点击"进入下一阶段"

9. **猎人开枪**（仅当猎人死亡时）
   - 若猎人被投票放逐，可以开枪带走一人
   - **注意**：被毒死不能开枪
   - 上帝点击"进入下一阶段"

10. **白天结算**
    - 进入下一回合，返回"恐惧阶段"

### 第六步：游戏结束

游戏在以下情况结束：
- **狼人胜利**：狼人数量 >= 好人数量
- **好人胜利**：所有狼人出局

系统会弹出胜利提示，所有玩家可以查看完整的游戏历史记录。

---

## 🎭 角色说明

### 狼人阵营（4人）

#### 1. 噩梦之影 x1
- **技能**：每晚恐惧一名玩家，使其无法使用技能
- **策略**：优先恐惧神职（女巫/预言家/摄梦人）

#### 2. 普通狼人 x3
- **技能**：每晚集体投票杀死一名玩家
- **策略**：与噩梦之影配合，先恐惧后刀人

### 好人阵营（8人）

#### 3. 摄梦人 x1
- **技能**：每晚守护一名玩家，若被守护者被刀则摄梦人替死
- **策略**：守护重要神职或可能被刀的玩家
- **注意**：成功守护会牺牲自己

#### 4. 女巫 x1
- **技能**：拥有一瓶解药（救人）和一瓶毒药（毒人）
- **解药**：可以救活当晚被狼刀的玩家（全局只能用1次）
- **毒药**：可以毒死一名玩家（全局只能用1次）
- **特殊规则**：首夜不救，被刀者死亡

#### 5. 预言家 x1
- **技能**：每晚查验一名玩家的身份（好人/狼人）
- **策略**：查验可疑玩家，白天引导好人投票

#### 6. 猎人 x1
- **技能**：死亡时可以开枪带走一名玩家
- **注意**：被女巫毒死不能开枪
- **策略**：尽量带走狼人

#### 7. 平民 x4
- **技能**：无特殊技能
- **策略**：通过发言和投票帮助好人阵营

---

## ❓ 常见问题

### Q1: 如何快速测试游戏？

**方法1**：单机测试（推荐）
1. 打开12个浏览器标签页
2. 依次登录 test1 到 test12（密码都是 test）
3. 所有玩家加入同一房间
4. 上帝分配角色并开始游戏

**方法2**：多人测试
1. 将房间码分享给朋友
2. 朋友注册账号或使用测试账号登录
3. 输入房间码加入

### Q2: 如何在不同设备上加入同一房间？

只要设备在同一局域网内，或服务器有公网IP：
1. 确保服务器运行在主机上
2. 将主机IP地址告知其他玩家
3. 其他玩家访问 `http://主机IP:3000`
4. 输入相同的房间码即可加入

### Q3: 游戏进行中可以中途加入吗？

不可以。游戏开始后房间会锁定，无法加入或离开。

### Q4: 如何查看游戏历史记录？

在游戏进行中或结束后：
- 上帝控制台会显示最近10条操作日志
- 可以滚动查看完整历史记录
- 每条记录包含：回合数、阶段、操作结果

### Q5: 如何重新开始新游戏？

1. 上帝创建新房间（会生成新的房间码）
2. 玩家重新加入新房间
3. 重新分配角色并开始

### Q6: 角色分配后可以修改吗？

不可以。一旦点击"确认分配"，角色就会下发给玩家，无法修改。
如需重新分配，请创建新房间。

### Q7: 如何创建管理员账号？

只能通过默认管理员账号创建：
1. 使用 admin/admin123 登录
2. 进入管理员控制台
3. 点击"创建用户"
4. 选择角色类型（管理员/上帝/玩家）

### Q8: 忘记密码怎么办？

目前系统不支持密码找回功能。请使用以下方法：
1. 联系管理员删除旧账号
2. 重新注册新账号

### Q9: 游戏卡在某个阶段无法继续？

上帝需要手动点击"进入下一阶段"按钮推进游戏。
系统不会自动进入下一阶段。

### Q10: 如何知道自己是否已经完成操作？

玩家提交操作后会收到"操作成功"的弹窗提示。
上帝控制台会显示"X号完成操作"的日志。

---

## 💡 游戏技巧

### 上帝技巧
1. 熟悉游戏流程，按顺序推进各个阶段
2. 记录重要信息（谁被恐惧、谁被守护、谁被查验等）
3. 使用随机分配功能节省时间
4. 注意观察历史记录，避免遗漏操作

### 玩家技巧
1. **狼人**：白天伪装身份，夜晚统一行动
2. **噩梦之影**：优先恐惧神职，打乱好人节奏
3. **摄梦人**：不要守护同一人两次，灵活守护
4. **女巫**：首夜建议不自救，保留解药给重要神职
5. **预言家**：查验关键位置，引导好人投票
6. **猎人**：隐藏身份，关键时刻开枪带走狼人
7. **平民**：观察发言，跟随神职投票

---

## 📞 技术支持

如遇到问题：
1. 检查服务器是否正常运行（终端无报错）
2. 检查客户端是否正常连接（浏览器控制台无报错）
3. 刷新浏览器页面重新登录
4. 重启服务器和客户端

---

## 🎉 开始游戏

现在你已经了解了所有游戏规则和操作方法，快来开始你的狼人杀之旅吧！

**祝游戏愉快！** 🐺
